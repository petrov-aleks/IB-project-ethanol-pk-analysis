---
title: "week_1"
format: html
editor: 
  markdown: 
    wrap: 72
---

```{r}
#| message: false
library(tidyverse)
library(tidyplots)
library(readr)
library(patchwork)

```

# Цели и задачи

-   Визуализация кривых концентрация-время (спагетти-плот)

    -   В виде индивидуальных кривых

    -   В виде среднего +- стандартное отклонение для каждой временной
        точки

-   Расчет основных фармакокинетических параметров: Cmax, tmax, AUC0-t ,
    β, Vd

    -   Центральная тенденция (mean, median)

    -   Разброс (sd, coefficient of variation (CV) )

-   Визуализация выборочных распределений всех параметров из предыдущего
    пункта с помощью Гистограмм Боксплотов

-   Интерпретация результатов и короткий отчет

```{r}
theme_set(
  theme_minimal(base_size = 18) +
    theme(
      plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
      axis.title = element_text(size = 18, face = "bold",hjust = 0.5),
      axis.text  = element_text(size = 15),
      legend.text = element_text(size = 14),
      legend.title = element_text(size = 15, face = "bold")
    )
)
```

```{r}
Jones_1984 <- read_csv("data/raw/Jones-1984.csv")

Jones_1984
```

## Спагетти-плоты

```{r}
#Спагетти-плот для каждого пациента
Jones_1984 %>% 
ggplot(aes(x = time_min,
             y = conc_g_per_L,
             group = subject_id,
             color = factor(subject_id))) +
  geom_line(alpha = 0.6) +
  geom_point(size = 0.8, alpha = 0.8) +
  labs(x = "Время, мин",
       y = "Концентрация, г/л",
       color = "Испытуемый",
       title = "График концентраций по испытуемым в виде индивидуальных кривых") +
  theme_bw() +
  theme(legend.position = "none")
           
```

```{r}
# Спагетти-плот каждой временной точки +-SD
Jones_1984 %>%
  group_by(time_min) %>%
  summarise(
    mean_conc = mean(conc_g_per_L),
    sd_conc = sd(conc_g_per_L)
  ) %>%
  ggplot(aes(x = time_min, y = mean_conc)) +
  geom_line(color = "blue", size = 1) +
  geom_ribbon(aes(ymin = mean_conc - sd_conc,
                  ymax = mean_conc + sd_conc),
              alpha = 0.2, fill = "lightblue") +
  labs(x = "Время, мин",
       y = "Средняя концентрация, г/л",
       title = "Средняя концентрация с +-SD по времени") +
  theme_bw()
```

## Расчет основных фармакокинетических параметров: Cmax, tmax, AUC0-t ,
β, Vd

```{r}
#Cmax

```
